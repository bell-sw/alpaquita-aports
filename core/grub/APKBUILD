# Description: grub is a program that runs at the computer startup and calls an
# OS into memory. It is flexible and allows you to make changes at boot time.

pkgname=grub
pkgver=2.06
pkgrel=18
pkgdesc="Multiboot boot loader"
url="https://www.gnu.org/software/grub/"
arch="all !s390x"
license="GPL-3.0-or-later"
depends="dracut"
triggers="grub.trigger=/boot"
makedepends="bison flex linux-headers xz-dev lvm2-dev fuse-dev squashfs-tools
	automake autoconf libtool python3 freetype-dev font-unifont gettext-dev"
install="$pkgname.post-upgrade"
# strip handled by grub Makefiles, abuild strip breaks xen pv-grub
options="!check !strip !stackprot !fortify !annobin"  # Cannot test boot loader.
subpackages="
	$pkgname-dev
	$pkgname-doc
	$pkgname-mkfont
	$pkgname-mount
	$pkgname-bash-completion:bashcomp:noarch
	"

# currently grub only builds on x86*, aarch64 and ppc* systems
case "$CARCH" in
	x86)		flavors="efi bios";;
	x86_64)		flavors="efi bios xenhost xenhost_pvh";;
	aarch64|arm*)	flavors="efi";;
	mips*)		flavors="qemu_mips";;
	riscv*)		flavors="efi";;
	ppc*)		flavors="ieee1275"; makedepends="$makedepends powerpc-utils" ;;
	s390x)		flavors="emu" ;;
esac
for f in $flavors; do
	[ "$f" = "xenhost_pvh" ] && continue # xenhost_pvh shipped in the xenhost subpackage
	subpackages="$subpackages $pkgname-$f"
done

# Patch number ranges:
# 0000..1000: fedora, https://src.fedoraproject.org/rpms/grub2/tree/rawhide
# 1001..1100: various upstream and alpine patches
# 1101..    : distro specific patches

source="https://ftp.gnu.org/gnu/grub/grub-$pkgver.tar.xz
	grub-xen-host_grub.cfg
	sbat.distro.csv

	0004-Add-support-for-Linux-EFI-stub-loading.patch
	0005-Rework-linux-command.patch
	0006-Rework-linux16-command.patch
	0007-Add-secureboot-support-on-efi-chainloader.patch
	0008-Make-any-of-the-loaders-that-link-in-efi-mode-honor-.patch
	0009-Handle-multi-arch-64-on-32-boot-in-linuxefi-loader.patch
	0017-Make-efi-machines-load-an-env-block-from-a-variable.patch
	0025-Add-.eh_frame-to-list-of-relocations-stripped.patch
	0049-Add-grub_efi_allocate_pool-and-grub_efi_free_pool-wr.patch
	0050-Use-grub_efi_.-memory-helpers-where-reasonable.patch
	0051-Add-PRIxGRUB_EFI_STATUS-and-use-it.patch
	0065-Add-grub_qdprintf-grub_dprintf-without-the-file-line.patch
	0066-Make-a-gdb-dprintf-that-tells-us-load-addresses.patch
	0067-Fixup-for-newer-compiler.patch
	0069-Fixup-for-newer-compiler.patch
	0088-Make-it-so-we-can-tell-configure-which-cflags-utils-.patch
	0097-arm-arm64-loader-Better-memory-allocation-and-error-.patch
	0098-Try-to-pick-better-locations-for-kernel-and-initrd.patch
	0099-Attempt-to-fix-up-all-the-places-Wsign-compare-error.patch
	0100-Don-t-use-Wno-sign-compare-Wno-conversion-Wno-error-.patch
	0101-x86-efi-Use-bounce-buffers-for-reading-to-addresses-.patch
	0102-x86-efi-Re-arrange-grub_cmd_linux-a-little-bit.patch
	0103-x86-efi-Make-our-own-allocator-for-kernel-stuff.patch
	0104-x86-efi-Allow-initrd-params-cmdline-allocations-abov.patch
	0106-Do-not-allow-stack-trampolines-anywhere.patch
	0126-efi-Set-image-base-address-before-jumping-to-the-PE-.patch
	0127-tpm-Don-t-propagate-TPM-measurement-errors-to-the-ve.patch
	0128-x86-efi-Reduce-maximum-bounce-buffer-size-to-16-MiB.patch
	0134-efilinux-Fix-integer-overflows-in-grub_cmd_initrd.patch
	0135-linuxefi-fail-kernel-validation-without-shim-protoco.patch
	0149-kern-file-Fix-error-handling-in-grub_file_open.patch
	0177-Allow-chainloading-EFI-apps-from-loop-mounts.patch
	0185-arm64-Fix-EFI-loader-kernel-image-allocation.patch
	0199-Where-present-ensure-config-util.h-precedes-config.h.patch
	0206-grub-core-loader-i386-efi-linux.c-do-not-validate-ke.patch
	0207-grub-core-loader-arm64-linux.c-do-not-validate-kerne.patch
	0208-grub-core-loader-efi-chainloader.c-do-not-validate-c.patch
	0209-grub-core-loader-efi-linux.c-drop-now-unused-grub_li.patch
	0212-loader-efi-chainloader-grub_load_and_start_image-doe.patch
	0213-loader-efi-chainloader-simplify-the-loader-state.patch
	0214-commands-boot-Add-API-to-pass-context-to-loader.patch
	0215-loader-efi-chainloader-Use-grub_loader_set_ex.patch
	0216-loader-i386-efi-linux-Avoid-a-use-after-free-in-the-.patch
	0217-loader-i386-efi-linux-Use-grub_loader_set_ex.patch
	0218-loader-i386-efi-linux-Fix-a-memory-leak-in-the-initr.patch
	0219-kern-efi-sb-Reject-non-kernel-files-in-the-shim_lock.patch
	0220-kern-file-Do-not-leak-device_name-on-error-in-grub_f.patch
	0221-video-readers-png-Abort-sooner-if-a-read-operation-f.patch
	0222-video-readers-png-Refuse-to-handle-multiple-image-he.patch
	0223-video-readers-png-Drop-greyscale-support-to-fix-heap.patch
	0224-video-readers-png-Avoid-heap-OOB-R-W-inserting-huff-.patch
	0225-video-readers-png-Sanity-check-some-huffman-codes.patch
	0226-video-readers-jpeg-Abort-sooner-if-a-read-operation-.patch
	0227-video-readers-jpeg-Do-not-reallocate-a-given-huff-ta.patch
	0228-video-readers-jpeg-Refuse-to-handle-multiple-start-o.patch
	0229-video-readers-jpeg-Block-int-underflow-wild-pointer-.patch
	0230-normal-charset-Fix-array-out-of-bounds-formatting-un.patch
	0231-net-netbuff-Block-overly-large-netbuff-allocs.patch
	0232-net-ip-Do-IP-fragment-maths-safely.patch
	0233-net-dns-Fix-double-free-addresses-on-corrupt-DNS-res.patch
	0234-net-dns-Don-t-read-past-the-end-of-the-string-we-re-.patch
	0235-net-tftp-Prevent-a-UAF-and-double-free-from-a-failed.patch
	0236-net-tftp-Avoid-a-trivial-UAF.patch
	0237-net-http-Do-not-tear-down-socket-if-it-s-already-bee.patch
	0238-net-http-Fix-OOB-write-for-split-http-headers.patch
	0239-net-http-Error-out-on-headers-with-LF-without-CR.patch
	0240-fs-f2fs-Do-not-read-past-the-end-of-nat-journal-entr.patch
	0241-fs-f2fs-Do-not-read-past-the-end-of-nat-bitmap.patch
	0242-fs-f2fs-Do-not-copy-file-names-that-are-too-long.patch
	0243-fs-btrfs-Fix-several-fuzz-issues-with-invalid-dir-it.patch
	0244-fs-btrfs-Fix-more-ASAN-and-SEGV-issues-found-with-fu.patch
	0245-fs-btrfs-Fix-more-fuzz-issues-related-to-chunks.patch
	0246-misc-Make-grub_min-and-grub_max-more-resilient.patch
	0248-misc-make-grub_boot_time-also-call-grub_dprintf-boot.patch
	0249-modules-make-.module_license-read-only.patch
	0250-modules-strip-.llvm_addrsig-sections-and-similar.patch
	0251-modules-Don-t-allocate-space-for-non-allocable-secti.patch
	0252-pe-add-the-DOS-header-struct-and-fix-some-bad-naming.patch
	0253-EFI-allocate-kernel-in-EFI_RUNTIME_SERVICES_CODE-ins.patch
	0254-modules-load-module-sections-at-page-aligned-address.patch
	0255-nx-add-memory-attribute-get-set-API.patch
	0256-nx-set-page-permissions-for-loaded-modules.patch
	0257-nx-set-attrs-in-our-kernel-loaders.patch
	0258-nx-set-the-nx-compatible-flag-in-EFI-grub-images.patch
	0263-efi-use-enumerated-array-positions-for-our-allocatio.patch
	0264-efi-split-allocation-policy-for-kernel-vs-initrd-mem.patch
	0265-efi-allocate-the-initrd-within-the-bounds-expressed-.patch
	0266-efi-use-EFI_LOADER_-CODE-DATA-for-kernel-and-initrd-.patch
	0272-loader-arm64-linux-Remove-magic-number-header-field-.patch
	0273-Correct-BSS-zeroing-on-aarch64.patch
	0274-linuxefi-Invalidate-i-cache-before-starting-the-kern.patch
	0275-x86-efi-Fix-an-incorrect-array-size-in-kernel-alloca.patch
	0279-font-Reject-glyphs-exceeds-font-max_glyph_width-or-f.patch
	0280-font-Fix-size-overflow-in-grub_font_get_glyph_intern.patch
	0281-font-Fix-several-integer-overflows-in-grub_font_cons.patch
	0282-font-Remove-grub_font_dup_glyph.patch
	0283-font-Fix-integer-overflow-in-ensure_comb_space.patch
	0284-font-Fix-integer-overflow-in-BMP-index.patch
	0285-font-Fix-integer-underflow-in-binary-search-of-char-.patch
	0286-kern-efi-sb-Enforce-verification-of-font-files.patch
	0287-fbutil-Fix-integer-overflow.patch
	0288-font-Fix-an-integer-underflow-in-blit_comb.patch
	0289-font-Harden-grub_font_blit_glyph-and-grub_font_blit_.patch
	0290-font-Assign-null_font-to-glyphs-in-ascii_font_glyph.patch
	0291-normal-charset-Fix-an-integer-overflow-in-grub_unico.patch
	0292-font-Try-opening-fonts-from-the-bundled-memdisk.patch

	1001-osdep-Introduce-include-grub-osdep-major.h-and-use-i.patch
	1002-osdep-linux-hostdisk-Use-stat-instead-of-udevadm-for.patch
	1003-build-Fix-build-error-with-binutils-2.36.patch
	1004-templates-Improve-initramfs-detection.patch
	1005-configure-Fix-misspelled-variable-BUILD_LDFAGS-BUILD.patch
	1006-loader-Drop-argv-argument-in-grub_initrd_load.patch
	1007-efi-Move-MS-DOS-stub-out-of-generic-PE-header-defini.patch
	1009-loader-arm64-linux-Account-for-COFF-headers-appearin.patch
	1010-arm64-efi-linux-Implement-LoadFile2-initrd-loading-p.patch
	1011-arm64-efi-linux-Ignore-FDT-unless-we-need-to-modify-.patch
	1012-templates-Filter-out-POSIX-locale-for-translation.patch
	1013-templates-Filter-C.UTF-8-locale-for-translation.patch
	1014-fs-ext2-Ignore-checksum-seed-incompat-feature.patch
	1015-fs-ext2-Ignore-the-large_dir-incompat-feature.patch
	1016-video-readers-Add-artificial-limit-to-image-dimensio.patch

	1017-Fix-grub-mkconfig-detection-of-linux-edge-virt.patch
	1018-ensure-grub-mkconfig-ignores-.apk-new-files.patch
	1019-prevent-harmless-LVM-warnings-from-grub-probe.patch
	1020-Handle-encrypted-zfs-root-partition.patch

	1101-fixes-for-menu.patch
	"

# secfixes:
#   2.06-r8:
#     - CVE-2022-3775
#     - CVE-2022-2601
#   2.06-r7:
#     - CVE-2022-28736
#     - CVE-2022-28735
#     - CVE-2022-28734
#     - CVE-2022-28733
#     - CVE-2021-3697
#     - CVE-2021-3696
#     - CVE-2021-3695
#   2.06-r0:
#     - CVE-2021-3418
#     - CVE-2020-10713
#     - CVE-2020-14308
#     - CVE-2020-14309
#     - CVE-2020-14310
#     - CVE-2020-14311
#     - CVE-2020-14372
#     - CVE-2020-15705
#     - CVE-2020-15706
#     - CVE-2020-15707
#     - CVE-2020-25632
#     - CVE-2020-25647
#     - CVE-2020-27749
#     - CVE-2020-27779
#     - CVE-2021-20225
#     - CVE-2021-20233

prepare() {
	default_prepare
	PYTHON=python3 sh ./autogen.sh
}

_build_flavor() {
	local flavor="$1"
	shift
	local _configure="$@"

	msg "Building grub for platform $flavor"
	mkdir -p "$srcdir"/build-$flavor
	cd "$srcdir"/build-$flavor
	$builddir/configure \
		--build=$CBUILD \
		--host=$CHOST \
		--target=$CTARGET \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--disable-nls \
		--disable-werror \
		--with-utils=host \
		$_configure
	make
}

build() {
	local f
	for f in $flavors; do
		case "$f" in
		bios)		CFLAGS="${CFLAGS/-fno-plt/}" \
				  _build_flavor $f --with-platform=pc;;
		efi)		_build_flavor $f --with-platform=efi --disable-efiemu;;
		xenhost)	_build_flavor $f --with-platform=xen;;
		xenhost_pvh)	CFLAGS="${CFLAGS/-fno-plt/}" \
				  _build_flavor $f --with-platform=xen_pvh --target=i386;;
		*)		_build_flavor $f --with-platform=$f;;

		esac
	done
}

_install_xen() {
	grub_dir=$(mktemp -d)
	cfg=$(mktemp)
	grub_memdisk=$(mktemp)

	mkdir -p $grub_dir/boot/grub
	echo 'normal (memdisk)/grub.cfg' > $cfg
	sed -e "s/@@PVBOOT_ARCH@@/$CARCH/g" \
		$srcdir/grub-xen-host_grub.cfg \
			> $grub_dir/grub.cfg
	tar -cf - -C $grub_dir grub.cfg > $grub_memdisk

	./grub-mkimage \
		-O $CARCH-xen \
		-c $cfg \
		-d ./grub-core ./grub-core/*.mod \
		-m $grub_memdisk \
		-o $pkgdir/grub-$CARCH-xen.bin

	rm -r "$grub_dir"
	rm "$cfg" "$grub_memdisk"
}

_install_xenpvh() {
	grub_dir=$(mktemp -d)
	cfg=$(mktemp)
	grub_memdisk=$(mktemp)

	mkdir -p $grub_dir/boot/grub
	echo 'normal (memdisk)/grub.cfg' > $cfg
	sed -e "s/@@PVBOOT_ARCH@@/$CARCH/g" \
		$srcdir/grub-xen-host_grub.cfg \
			> $grub_dir/grub.cfg
	tar -cf - -C $grub_dir grub.cfg > $grub_memdisk

	echo "About to run grub-mkimage in: $PWD"
	# Note: only i386-xen_pvh supported
	./grub-mkimage \
		-O i386-xen_pvh \
		-c $cfg \
		-d ./grub-core ./grub-core/*.mod \
		-m $grub_memdisk \
		-o $pkgdir/grub-i386-xen_pvh.bin

	rm -r "$grub_dir"
	rm "$cfg" "$grub_memdisk"
}

_install_flavor() {
	local flavor="$1"
	cd "$srcdir"/build-$flavor
	case $flavor in
	xenhost)	_install_xen;;
	xenhost_pvh)	_install_xenpvh;;
	*)	 	make DESTDIR="$pkgdir" install-strip;;
	esac
}

package() {
	# install BIOS & EFI version into the same directory
	# and overwrite similar files.
	for f in $flavors; do
		_install_flavor $f
	done

	rm -f "$pkgdir"/usr/lib/charset.alias
	# remove grub-install warning of missing directory
	mkdir -p "$pkgdir"/usr/share/locale

	mkdir -p "$pkgdir"/etc/default/
	cat >"$pkgdir"/etc/default/grub <<-EOF
		GRUB_TIMEOUT=0
		GRUB_TIMEOUT_STYLE=hidden
		GRUB_DISABLE_SUBMENU=y
		GRUB_DISABLE_RECOVERY=true
		GRUB_CMDLINE_LINUX_DEFAULT="quiet"
		GRUB_DEFAULT=saved

		# Note that os-prober is not installed by default, therefore
		# /etc/grub.d/30_os-prober is no-op. In order to use it,
		# you need to install the os-prober package.
		GRUB_DISABLE_OS_PROBER=false
	EOF

	mkdir -p "$pkgdir"/usr/share/bash-completion
	mv "$pkgdir"/etc/bash_completion.d "$pkgdir"/usr/share/bash-completion/completions
}

bios() {
	pkgdesc="$pkgdesc (BIOS version)"
	depends="$pkgname"
	mkdir -p $subpkgdir/usr/lib/grub
	mv $pkgdir/usr/lib/grub/*-pc $subpkgdir/usr/lib/grub/
}

_grub_gen_earlyconf() {
	cat <<- EOF
	search --no-floppy --set=root --label "$VENDOR_DISTRO $CARCH"
	set prefix=(\$root)/boot/grub
	EOF
}

efi() {
	pkgdesc="$pkgdesc (EFI version)"
	depends="$pkgname"
	mkdir -p $subpkgdir/usr/lib/grub
	mv $pkgdir/usr/lib/grub/*-efi $subpkgdir/usr/lib/grub/

	local _cd_modules="\
		all_video cat configfile disk echo fat gzio help \
		iso9660 linux ls memdisk normal part_gpt part_msdos \
		search search_label squash4 test true \
		"

	local _modules="$_cd_modules \
		at_keyboard boot btrfs cryptodisk efifwsetup efinet ext2 f2fs \
		font gcry_rijndael gcry_rsa gcry_serpent gcry_sha256 gcry_sha512 \
		gcry_twofish gcry_whirlpool gfxmenu gfxterm halt hfsplus http \
		jpeg loadenv loopback lsefi lsefimmap luks lvm mdraid09 mdraid1x \
		minicmd part_apple password_pbkdf2 png reboot regexp search_fs_file \
		search_fs_uuid serial sleep tftp video xfs zstd \
		"

	local _format _efi

	case "$CARCH" in
	aarch64)_format="arm64-efi";  _efi="aa64.efi" ;;
	arm*)	_format="arm-efi";    _efi="arm.efi"  ;;
	x86)	_format="i386-efi";   _efi="ia32.efi" ;;
	x86_64) _format="x86_64-efi"; _efi="x64.efi"  ;;
	*)	return 0 ;;
	esac

	local _install_dir="$subpkgdir/usr/lib/grub/$_format/unified"

	mkdir -p $_install_dir
	_grub_gen_earlyconf > "$builddir"/grub_early.cfg

	sed -e "s,@PKGVER@,$pkgver,g" -e "s,@PKGREL@,$pkgrel," \
		-e "s,@DISTRO@,$VENDOR_DISTRO,g" -e "s,@DISTRO_NAME@,$VENDOR_DISTRO_NAME,g" \
		-e "s,@SUPPORT_URL@,$VENDOR_BUG_REPORT_URL,g" \
		< "$srcdir"/sbat.distro.csv > "$builddir"/sbat.distro.csv

	# create memdisk with fonts
	local grub_dir=$(mktemp -d)
	local grub_memdisk=$(mktemp)

	mkdir -p $grub_dir/fonts
	cp "$pkgdir"/usr/share/grub/unicode.pf2 $grub_dir/fonts
	mksquashfs $grub_dir $grub_memdisk -noappend

	# Create unified grub efi with .sbat section for signing
	# For cd/iso image boot
	"$srcdir"/build-efi/grub-mkimage \
		--directory="$subpkgdir/usr/lib/grub/$_format" \
		--config="$builddir/grub_early.cfg" \
		--output="$_install_dir/gcd$_efi" \
		--format="$_format" \
		--compression="xz" \
		--sbat="$builddir/sbat.distro.csv" \
		--memdisk=$grub_memdisk \
		--prefix="/boot/grub" \
		$_cd_modules

	# For normal boot
	"$srcdir"/build-efi/grub-mkimage \
		--directory="$subpkgdir/usr/lib/grub/$_format" \
		--output="$_install_dir/grub$_efi" \
		--format="$_format" \
		--sbat="$builddir/sbat.distro.csv" \
		--memdisk=$grub_memdisk \
		--prefix="/EFI/$VENDOR_DISTRO" \
		$_modules

	rm -r $grub_dir
	rm "$grub_memdisk"
}

xenhost() {
	pkgdesc="$pkgdesc (XEN host version)"
	mkdir -p $subpkgdir/usr/lib/grub-xen
	mv $pkgdir/*-xen.bin $subpkgdir/usr/lib/grub-xen/

	# pick up result from xenhost_pvh build as well
	mv $pkgdir/*-xen_pvh.bin $subpkgdir/usr/lib/grub-xen/
}

qemu_mips() {
	pkgdesc="$pkgdesc (QEMU MIPS version)"
	depends="$pkgname"
	mkdir -p $subpkgdir/usr/lib/grub
	mv $pkgdir/usr/lib/grub/*-qemu_mips $subpkgdir/usr/lib/grub/
}

ieee1275() {
	pkgdesc="$pkgdesc (IEEE1275 version)"
	depends="$pkgname powerpc-utils"
	mkdir -p $subpkgdir/usr/lib/grub
	mv $pkgdir/usr/lib/grub/*-ieee1275 $subpkgdir/usr/lib/grub/
}

emu() {
	pkgdesc="$pkgdesc (EMU version)"
	depends="$pkgname"
	mkdir -p $subpkgdir/usr/lib/grub
	mv $pkgdir/usr/lib/grub/*-emu $subpkgdir/usr/lib/grub/
}

mkfont() {
	pkgdesc="$pkgdesc (mkfont utility)"
	depends="$pkgname"
	mkdir -p $subpkgdir/usr/bin
	mv $pkgdir/usr/bin/grub-mkfont $subpkgdir/usr/bin/
}

mount() {
	pkgdesc="$pkgdesc (mount utility)"
	depends=""
	mkdir -p $subpkgdir/usr/bin
	mv $pkgdir/usr/bin/grub-mount $subpkgdir/usr/bin/
}

bashcomp() {
	depends=""
	pkgdesc="Bash completions for $pkgname"
	install_if="$pkgname=$pkgver-r$pkgrel bash-completion"

	amove usr/share/bash-completion/completions
}

sha512sums="
4f11c648f3078567e53fc0c74d5026fdc6da4be27d188975e79d9a4df817ade0fe5ad2ddd694238a07edc45adfa02943d83c57767dd51548102b375e529e8efe  grub-2.06.tar.xz
4e7394e0fff6772c89683039ccf81099ebbfe4f498e6df408977a1488fd59389b6e19afdbf0860ec271e2b2aea0df7216243dcc8235d1ca3af0e7f4d0a9d60a4  grub-xen-host_grub.cfg
3bdefa7effaba59d23110cdd60598bd3cc91cac82792df76adbb98cc0cff17ae3cd0ac1684795ada31651166e9d06bc7be7b0a856e4d0be95828689458dbf37f  sbat.distro.csv
c1601f2c2293da193c9ca76191a2934c16138ac30d9eec24a0a50454dbf4f28094875eb45f33b297fcef689c16ac1e2f2f584d49601733a1da8632aa96f9bfe3  0004-Add-support-for-Linux-EFI-stub-loading.patch
3ca03148e8f1943d94182670070cea204d51a4f7285f243e7ccf08d9c3d7b111d38ed754648a820b52ac9c68a29c52fd18c7a29ae461e2a20ab036b3762caf03  0005-Rework-linux-command.patch
d831124d84d890413d2aec7a75d4bbf1684c64dbf8ab7f46472ce36ad5e30f2c110b62ce0ac75bda7257a13f9024e7c135109b4f15250416fdd1c26a5fea2d49  0006-Rework-linux16-command.patch
48e8ed301497cda587bfba8312787d9ea8cbb6e419ea232ee9f3e24afee6074a7e9f54b8c77ea4db16cd239a9d8e120907f6acdb7e8edfc6dd34223905ea5305  0007-Add-secureboot-support-on-efi-chainloader.patch
51f0ad4d18a41757188a125af52a139bb0b7f0b71e3723f9714aa1c43c97020a123d5317c316de77d6295dc4048dc7d25799544f91e1838eeb66e760de9954ae  0008-Make-any-of-the-loaders-that-link-in-efi-mode-honor-.patch
012cdc40e5cee38d4218e149e966010d83ebe00af33592e0f981dd39d2061e19ce2c73752243c638fd100e95e36c14da9bd220c7e27ad09b64f9bf4946dfb507  0009-Handle-multi-arch-64-on-32-boot-in-linuxefi-loader.patch
c583f489961a6fb6e0aba38e09e218d00f916f9456d642b5198c2034e4cba475e7be420d31532ed110f8568329aeb105b83c4432f9fe46fefe857f9b4b34e454  0017-Make-efi-machines-load-an-env-block-from-a-variable.patch
83ffe15795daed83c2e9293afa2c39d08f377af60a579b2325250653215c106086c1f89c77d7430d74413c168995f3160a5c1a40548dad34c56d0fedb4301161  0025-Add-.eh_frame-to-list-of-relocations-stripped.patch
f59a17a8b6e8050571197774eb6086150e4ff009c040506c74a094907d1bd1de3d279f005b8183bfe2897980d0cf01f3e887eec7170b29de2e933018b8a749ca  0049-Add-grub_efi_allocate_pool-and-grub_efi_free_pool-wr.patch
fcb7b52acfd06c3b798ba6a700ce8196479a04eb4b5a099926dc94f2902686ec0e7b5c321d3ac579c54dc9da004a6874b2e7acbbc9818f21b8eee905323857a6  0050-Use-grub_efi_.-memory-helpers-where-reasonable.patch
14d358bae89e76e6c7955d37a66820424f5e314283184eb07e59762f6c6018b66a965b21a5db17a81c3278f72fd7a0a1786ae4d2c0d71991e13690684c2071e5  0051-Add-PRIxGRUB_EFI_STATUS-and-use-it.patch
139234bc6aa42c1d185425d3e5cbec2d1c393903a854a9948ecd77e3cdfcd8ebfaf6dc574a60371852886f1ab490cf23a5c4c06141da37e7c93bc28d4b77dde5  0065-Add-grub_qdprintf-grub_dprintf-without-the-file-line.patch
774eb15ea0f51125b6a556300017fd8902a9d5583a707b8ac7bf7e8bf59ac6c477dcd836561ec6d23e4d8c0324ae2583891dc0a795fa16ee338d5b017f613465  0066-Make-a-gdb-dprintf-that-tells-us-load-addresses.patch
9a410a033873d084be8a71cc7eb483290e4ec13a336bcf29819e0a2d88e4960033f40dcc23b254f65368f32743179a37a85a782193c8ad828b95be9390287867  0067-Fixup-for-newer-compiler.patch
689a9cbe50b358b6043f21349dcb2a485e0ab3aa88e9342ede72b4db76fd766cdd4abbe328307fb62d8f487ad3fcf4219644fee5c048ee42232bce8b53bad11f  0069-Fixup-for-newer-compiler.patch
cde9a1067bdfdd9e2ce264f18449962576e7eb4b3ae46e220b0e81ebc8fc35b198e55d2ab9277d3146de1c5abecf901882de540cb39e8982108d7c790a949009  0088-Make-it-so-we-can-tell-configure-which-cflags-utils-.patch
d36abd7ae73e3d3a54bbc4a851551b0c2fdb604840cc8756ef718175c0b24051a724d037be36347ea97c50793c8d9a41d866cd2847b530029076ab9edc32392b  0097-arm-arm64-loader-Better-memory-allocation-and-error-.patch
137ef45471081025a041ee51096ec69e6a1a8161595f6a4549d6c48c3a5d7d5629319ff701abfd2d28b90f56ab61d035ffce8e642790a05c34de828d9f51611b  0098-Try-to-pick-better-locations-for-kernel-and-initrd.patch
483357a1ad268e2a823b22f025f53b82554c63ab8e9372f589a5ea2174cf068772faaac13ec575d38e383a410d3c2f67c9ad38665c5c3754836327badfefa1ec  0099-Attempt-to-fix-up-all-the-places-Wsign-compare-error.patch
534428a25056b7882b0d6d4f0691d247b8a51cc4e36693c750a9cf9569d635497419672de88ddf90313cd7bc5b9ad084f0f5ba68f8d9f53726a233e245fd6595  0100-Don-t-use-Wno-sign-compare-Wno-conversion-Wno-error-.patch
179eaa565a433d5a5014867fc1d9257dfd4af378f5dea8058b8abc9b613d96391afdd97c16730d8af2c5d8217421f8e6edc8a017815d77e45fdb18e712446681  0101-x86-efi-Use-bounce-buffers-for-reading-to-addresses-.patch
63d5a6e5de44be3a2d362e5afdb36d86598c9a663eceec5c46126e7100a1feba2af1b4ce0ab82aa4b110d74a8c1b6e9b103e3273920fc4b66161a74bf9c8d265  0102-x86-efi-Re-arrange-grub_cmd_linux-a-little-bit.patch
b7f9d362f7d18a280421cbadfc9891d75febb40b7131b2a40bc5ce8023824873b74ca926fd5a1c2282aef37cbf1217c0ca01aec94f206dff57a5b413f4005f07  0103-x86-efi-Make-our-own-allocator-for-kernel-stuff.patch
c72754ab7d3a15d2183cd0cd1d0dad46e6b3996587be7f9275c45448c74500984524b11d8a3caeb4928aeb1a137b30909540d56d51968a427b7fba7bd2849da0  0104-x86-efi-Allow-initrd-params-cmdline-allocations-abov.patch
1514a333a781e29927d78df5493d2a731432f6d48db56d5e6ab9ef0f48b11692d640e32a5686148bdd3c1aa08444cea693d9fb590814eb80c3c7b8dcc02fffc5  0106-Do-not-allow-stack-trampolines-anywhere.patch
9e14f043095f01a3054a0a831801931f866a41b822710e5c3d5c6b684bd6b3a57cc3c1e67520e8e166734d2f383daea4bfdafd9dd3496e72d7cefe5f5f1161e0  0126-efi-Set-image-base-address-before-jumping-to-the-PE-.patch
7d8c48dbe7ba61c8ade4cbe8c1e45666a58266b171658aeb013295e7ba8bfc754fe9b12ad4d083bf061cb4e48ffdcea9830d9b75b1228988a5c249b7eee922c9  0127-tpm-Don-t-propagate-TPM-measurement-errors-to-the-ve.patch
2ec353c55c2986bfacc57f4f72bb3107df99f9d811fa59d1df8962b07594361d69a42a9aa60ea2467e71428b97ab05e6191a65cbd554dd573115564af68eac5d  0128-x86-efi-Reduce-maximum-bounce-buffer-size-to-16-MiB.patch
037b913d99570ccb9bf2ea6af50b610b2b449f2fdf6c09d36e870391d8fd0fb131ea54300e5efae6ec65979388705121855392e9cbca0cff7cdd33371043fd25  0134-efilinux-Fix-integer-overflows-in-grub_cmd_initrd.patch
fc1285f6e94fb38cc4268e7172a318c56e12eece361ae0f1ba827a23fbedf3c3ab41e6ad55f86d796fa7bb37757cdec811fe26b20e200b3cce6b0847fd428d6a  0135-linuxefi-fail-kernel-validation-without-shim-protoco.patch
bc408cc031829be5589174559a8b93d6da30e287066bfa8ea9249db06552f67a2753beddd0e894b57dcee865212b7eab1d6178d0fd93cf00bd5c812c2aa4a838  0149-kern-file-Fix-error-handling-in-grub_file_open.patch
5b838af67196b678ebd85934b32ddbdab98ea6e6d2b6fe8f6ca53f580ac630d2ec9e1b83520468ebb9ffffd41bde93be1a82caf48d368c61ffb245ea5bf6b306  0177-Allow-chainloading-EFI-apps-from-loop-mounts.patch
2b72251d806251d899e70db5cbb05b6c4aaa55e8c3562d95b616a99f0ca75ba5d9cfa1c6697a3ae9fc4e5e5c191f95d78afab5db1b2a3a40f707999ba6c2f1a4  0185-arm64-Fix-EFI-loader-kernel-image-allocation.patch
f3a1716fbd37dcb93a8229d037bb6f36a4c8c3da35b83807401a718166fa7d27fddfedeb732b738933365cde2d12fdba128b1031169a1173a3da83488f6a744d  0199-Where-present-ensure-config-util.h-precedes-config.h.patch
84b6c8b272f95c2e899a86c51d06780ea0561d80ef506719554b27a6e51ccad7a68a5286b650ed7db9b0c3093664eeec5191a38dd8e82fecbaf010bdf6df0171  0206-grub-core-loader-i386-efi-linux.c-do-not-validate-ke.patch
a2b6fd806857c9e5b894f065b8f78dd994c067ca963dc0dbfe0c1abff172a5beb9c47ca8072424882f7336762ddc47e6ad2f2fc73f0a801cd6f2aa8ed5ea4828  0207-grub-core-loader-arm64-linux.c-do-not-validate-kerne.patch
c98a4ab300ff53d9f90ca8dc0a61721f835cdcdeaf56b7aa08f34bc0e6cb90b333bf3f146f76eb9eaf4ff1bbb8a13489d25e37f9dbd9f21be1ef23fad5297a50  0208-grub-core-loader-efi-chainloader.c-do-not-validate-c.patch
95a583bd34e6d4b91329abfdb4f037c4f0d223cd03604359db83e7a545e18fcaa01ae7bc1b19643a77d06bedc7f97f59fedad112d20768403f885d9e23602a5c  0209-grub-core-loader-efi-linux.c-drop-now-unused-grub_li.patch
ec3563ffc74af64a625cf55aee42081552c004657a59795565d78dac2ae465885c1abeb6767fe019baf55c83cabec4f54829ae64196c3b288413108c39e9c8c5  0212-loader-efi-chainloader-grub_load_and_start_image-doe.patch
f6ca0ceafb54a767d2702ae3486c9e570e71e04796803a30fef02a16f678277c540f74698e8c4d8f80103bc8982d072b439dde14c08cbbee9a6cdd05e1385e27  0213-loader-efi-chainloader-simplify-the-loader-state.patch
6e81b02847ff00559e6cbd25a61746c2b502726fbf60d6db275aeb7525311cd965d70c369972cfc5017be41d9317848b8dee97dca1d592db5f1b41aee768e03f  0214-commands-boot-Add-API-to-pass-context-to-loader.patch
daacaa344e60c422bfa79560c0b6320021bd95ea428c33ca3725f24b17d7dcb91ba24c62b6ee79eadb3da1cb85b501f9d800ee48f89ba2fc56675aff43b5b415  0215-loader-efi-chainloader-Use-grub_loader_set_ex.patch
7011b47a8275d39580ada18ee0102ec4fc5fe84068421f8b5edea167d98c0248d2af9cd022bd391356ffe3f564f77c60246374ebe8c862bb2f53ed8b76150489  0216-loader-i386-efi-linux-Avoid-a-use-after-free-in-the-.patch
5d621dbd7449ee08ef69c350c545a568388aad498ff76cd99df2ba6ed0ffd3f25a2f5fc173e6d18a0dd33a15ee59ed9939e7f445636263779a98b43254ba7761  0217-loader-i386-efi-linux-Use-grub_loader_set_ex.patch
bf31892525001949576f2afe6cc4b1f561806d76d49761a600208f76c6b42b9745e64af85707feb70d6059c608b597e0434c8ebc287af3096607bef9c49a9594  0218-loader-i386-efi-linux-Fix-a-memory-leak-in-the-initr.patch
ad7a2fbcb588e8c72321cfec51f427b639767e01c69a2620860450f087657c7984e69cba3eecbf3fe1646d1d449c3e26043acd62de5fcdf6c83e993630c880c0  0219-kern-efi-sb-Reject-non-kernel-files-in-the-shim_lock.patch
e147eecf407f572c7a2b9b5b2384bb6c9bf91802877b6de67688198060386917b2656505545591a07cf215e97dd164c17579bf2c7034c41b26aaa0fbfd9b7a43  0220-kern-file-Do-not-leak-device_name-on-error-in-grub_f.patch
c8fbfb980777bc670623a185e491d9ce156aaded1bd63187a65fd04b840821177390db7e3da69ec1d066869aee7ab61f08e6a91649a741190642ecd97cdcf081  0221-video-readers-png-Abort-sooner-if-a-read-operation-f.patch
1008074cdd21ffa0a9d9157251a125bd776e5f31e2ecb2084acd54087cfde289c19f9ffdc58e0ac9380d5afd0630e0e5d53a67c013177df9863c261ee49f7b2b  0222-video-readers-png-Refuse-to-handle-multiple-image-he.patch
83d3b67e8f879a080dca5394ddbcdeecf17e63d6b18ce6172d1cc014d2643a7a5454a3a6572c45c48e441c1b20ddc087c26a839ec0d7f689ceb746bfeab2b5dd  0223-video-readers-png-Drop-greyscale-support-to-fix-heap.patch
a10b99babb9167d01410285c11a1f9acb6b1c7e8e40146ee8d9ef37c6fff41e082d4d72b305b715352d969181fdf54006ea2af87f177fe0891386b6f7aceb5fc  0224-video-readers-png-Avoid-heap-OOB-R-W-inserting-huff-.patch
381e78b9ce76288271e6e04e18c398385c0ee3b0af52fd94cbb1e969499c16de25988006cfe69ae230caac92909abb03db436eb05433396ed5e29dcc781fd6fe  0225-video-readers-png-Sanity-check-some-huffman-codes.patch
016826c176702222fe8656fad8591253c8eb4fa36905632238f254fcf1b89905d55d3d9b2c51c45d9c1d3a9479586e7b9adb00275e8a38e0a20bbecd9e75a1c6  0226-video-readers-jpeg-Abort-sooner-if-a-read-operation-.patch
8b8bf915dcc616782f1f0ef93623a99eb32d7d77450430ce7712ca0e2ba0bda659a740da8d1cf2d52d8ba4133866ade2f79f57d913a471bff14f4a4067be2b58  0227-video-readers-jpeg-Do-not-reallocate-a-given-huff-ta.patch
67b0919bdb9c4d7caac97d832d1eea07643c0186d8cc11a1eafc3ab53a855dd5dc8d3c3cf48268fd97032089556407eaaf715bc28440edae7c5fb2ce2c4b9eef  0228-video-readers-jpeg-Refuse-to-handle-multiple-start-o.patch
b79577f3d8c29e3d3676f5e2a8246a093927e34dc2f25132132d1019a9f67648543c7291c15066bba74b8ab9346d9da4d2db3aea401c0b2a20996f8f00ec939b  0229-video-readers-jpeg-Block-int-underflow-wild-pointer-.patch
a5047f20a9a3d1cebf7f5a1ca6e2087f438bc65d04cf3b31caac469b46562f6f6d63e48860bb743637b95cc786e5be8adce3c715a9aa4c8f43cc7c1eab2b294e  0230-normal-charset-Fix-array-out-of-bounds-formatting-un.patch
eb60eabaf752d0dc8743e98587afc7680dceb0d4749980d5d0fcb57ca1de773e91a72da5d14028a3887a4d8e0db1623fe25a1b7952d9e0b3db9deeecf821f6ff  0231-net-netbuff-Block-overly-large-netbuff-allocs.patch
7f8b49a94df9007bae53b7ae259e421908493ce96b6272e625f8afa6d3037190bc15638e1a74e305065ac47a882c114e170725fc51a4717b03ca5836fdd86cb1  0232-net-ip-Do-IP-fragment-maths-safely.patch
4f578d23c1f32e04ef632ef57d1f214b31c4725c51965a6d3383a3dbfa4c760d9deb1f829d6a84a7eea851cb239e9613748dcb16eabdc5baa43b9d2c2d96894f  0233-net-dns-Fix-double-free-addresses-on-corrupt-DNS-res.patch
1b8d92609af830aa5b7336ce4f7e3395b710d63cf28f72b3819b0de0389fb6df48f44479f232231444b0f52eaa25ee196dc4da8b7f48c7fb6293a27e7d6c844f  0234-net-dns-Don-t-read-past-the-end-of-the-string-we-re-.patch
918aab17031aad5319d3eac8ed1238374d64a090b6f2e90d4543968288b116f1f7559ddf49d6290e455d7244d0207f3be062f2cf0be02aab5a0f8c9d81156dbd  0235-net-tftp-Prevent-a-UAF-and-double-free-from-a-failed.patch
5591143f52e00d680df639e1ec7afc7a0dc4ca4389b87c36772c1948f0ad5e4b874ff3360ae0d64b294d5397e4612db4501ab55086c0764fac676899370c5774  0236-net-tftp-Avoid-a-trivial-UAF.patch
a5402f793bcceb135547d268059c01e387d697d16a4ce11a2aafcc00b82f3f7064637b9bc6004882f1be47de0597ad5120461b5b4f0516ebcaa25401d26b2530  0237-net-http-Do-not-tear-down-socket-if-it-s-already-bee.patch
ba45a8fcc1ba328c23dc36d61e205988c3c81c9aed229d69556b8e038a7eeb86bc66b5c928571cea1cb3df8f5bda22119a0dad3449ab859fa918a7c6c73210e4  0238-net-http-Fix-OOB-write-for-split-http-headers.patch
0a34103324927f238b34ef6720209143dbb0c84726eb4d91d875848b46a171aec1730447245e953b344d128aaa061b7b0457399ffcfa198c82089776fe271111  0239-net-http-Error-out-on-headers-with-LF-without-CR.patch
c6275d122855c28515af4d76aafe20e05a3971db02c47bfb8b646244cbae1fa692481392f634073494d18a52d00721c36928828a675c74a4b979633f4f999d42  0240-fs-f2fs-Do-not-read-past-the-end-of-nat-journal-entr.patch
c0d141425d9e666ab6689ed3a1ea3b23c7e83c5ff33eab441f94e4374004c523d9d1cf51a2c4919dc687e4967e116373a199afc1944e4a3f810927011b1dc273  0241-fs-f2fs-Do-not-read-past-the-end-of-nat-bitmap.patch
c65c60938092da16da8e3a0c978b9222255706d3cb835369064362943d3d95d5c543c8002a5fc72dff6e18e2d8db40d0b0ab455551c4ac3c0ac77ad943ebdbdb  0242-fs-f2fs-Do-not-copy-file-names-that-are-too-long.patch
237ac1f0f11ee081abbbb6b1cc2ad11609a82ba7f768fa1f2fa2f856638d127e3c6071bb444bafdf4312b7d9a74986cb99479c8546765610959ad907da14f111  0243-fs-btrfs-Fix-several-fuzz-issues-with-invalid-dir-it.patch
25222c54522212b6289b94da46f700bc28ce9dd1779ae648e41b11c3f404a004a376bfd7784577cd0cec8a5c5c51333ce7d746322955cc90e06bfde5a2fefca1  0244-fs-btrfs-Fix-more-ASAN-and-SEGV-issues-found-with-fu.patch
8aec43e5e3c6d7ec75e57d4ba1437cc3becf07abfea2315e6d406ae5b505516dc53a5180fc8295bde910d37ae2595b97a2a44437e3b5c7f21f784ea18c12d48c  0245-fs-btrfs-Fix-more-fuzz-issues-related-to-chunks.patch
5db385b4b2e2a3bb327bd5163ca67aea4939e680155d42bdc39deb1f62bd7150ec407d66712a2f4f2b875b22a1bc08deb79f63cdb6dd45c18f460ec695113a4d  0246-misc-Make-grub_min-and-grub_max-more-resilient.patch
1323f8388cef81e5cd23ce7537b7c4f408f8c9ac73b7f9ecb6dea522c9373307a1b6995e42c24a1ad30d95c34b9b228ddc96430d125d603926c78b26910590e5  0248-misc-make-grub_boot_time-also-call-grub_dprintf-boot.patch
2b509bdaa6f0a0f5276dc9f6af5b0c2589efbf43c8d1fcb0e7ba075668e51d4046b1f0225dc1d34125eaf07168c86af5bc72175ee7eec2dbecd9461a0d9276aa  0249-modules-make-.module_license-read-only.patch
d79698d08bd483dabc47697f8f76718ce39f4ad9535e156139e8cd4b6f5a018d7f2de9cd650dbe6f31d986bab21c55ce725295d34f9cf69fd4f87db1cd194f4f  0250-modules-strip-.llvm_addrsig-sections-and-similar.patch
020dd73235e8aec888ce56041a4cc908db4e5f06ebe6520a9c52fc70dd2e657e47c997edbdf4a36fb7609b4cf6631f861868b836e36a6086eb03910665ee03d6  0251-modules-Don-t-allocate-space-for-non-allocable-secti.patch
17911e5d5d872a5d8b6e2f68136c2ce918ff2ae4786d8ef3810d07f04c0d8ad3b3040a1897ee6a0652233a2475e10671c51bd2bb88bc7dff6ee53a34f94f8766  0252-pe-add-the-DOS-header-struct-and-fix-some-bad-naming.patch
5bdcc23915ef3b1fe2cf49921bf9e80c1e884f5241cb9e387eb97f622d7abbedbe1a4ed44ce7b30bdf5584ae1634cde539ad87fc490e41299990be4087d7d393  0253-EFI-allocate-kernel-in-EFI_RUNTIME_SERVICES_CODE-ins.patch
f08053a73e3fc6b16418cf4453fc3b132f6e531997f8be683c6cc04775ed2c5fac6992f76945ba138caef10324b0d0de5a9c980ab688dc33d6b6fb6be257e6e9  0254-modules-load-module-sections-at-page-aligned-address.patch
dcd97a5a6540076802e7a60b84c91f2f9aaee5e49fd9029c7c1ffc12799c30caa1324ed1a3ad6b24fec7c201e6cf21fde21af1e5601c5a47c9471203f8382431  0255-nx-add-memory-attribute-get-set-API.patch
b95bb02fb8479ef3e53b6038229d5a7f0d0423c06dac398e1cc44bcc055c580b8822d8793020a0f875dbeee713f5f7a9fe3485d118c8b86c7e64c4701f50b514  0256-nx-set-page-permissions-for-loaded-modules.patch
8bf67309ae4dcee31e0b388e2cef2077aff7c55bbc78f0d797a2fabd81174dad0f964c4ad51e6c71cc3b5e30f502415f1e918bd8cb5e8f9a5e3eb2e8153e41b1  0257-nx-set-attrs-in-our-kernel-loaders.patch
e0fa76a01d33d6367db947e5be114dbea5fde4141e3b0cd8bcc2f3b95541b32c3b7220efd14a82e1d63f422b5d9131c7c738a2389b1fc2ae7c448ed500ca9a45  0258-nx-set-the-nx-compatible-flag-in-EFI-grub-images.patch
a85a92d1cdf91c3cf070f72fae7950242090890388253d378c074a05d26d515358cf4406fc44ec06f64ee75f4dd3537d7942b71ef3311a54b080d3b8a050c26a  0263-efi-use-enumerated-array-positions-for-our-allocatio.patch
99899a83b8d828094f84211c83a81e9efa48aaea8f98ee3141295feb09144c9556c5daffa490a634797a76892f6c1bf8f86b6e381351531a1711e03bf6fdb7d1  0264-efi-split-allocation-policy-for-kernel-vs-initrd-mem.patch
fd67d69d6cb15f97fbbc39aabf72079ab08682bf6dee21f073e0744fe2da9e810a1d385c9cf927e0acf6460a0007c3b6d1568e5ea9786968ee587a12ce0393a1  0265-efi-allocate-the-initrd-within-the-bounds-expressed-.patch
dfad8e0895745b9865916b456e198d1fd82ca0db6939d232d6af9db32e1568c019915110ac9c88ebb929f1d46df1c5f05beff695a6e6930f5e755e4f0b6507d6  0266-efi-use-EFI_LOADER_-CODE-DATA-for-kernel-and-initrd-.patch
7da3b3c7eaf9e9cb9a3576f58f7df77040caf855bb98c7b54beec9170034f9ad39ffc5dfe48dbe94cec3b939d89e32b7966f39cb94b2d50bd0de6c09bbcc9ce8  0272-loader-arm64-linux-Remove-magic-number-header-field-.patch
629f3a82b10d233de8b78faceaf1029ef00526498ab870f8a04ecd24179daaceb167d1741b827f7b55151c70207419650565a3a044f34d9cf0478ad99c6702de  0273-Correct-BSS-zeroing-on-aarch64.patch
1bb895d0d17ba686582fce737df1eb42a4f9d1cbc2f37ebb71d9a71b38ca0179d9d71af133b429f61e5577d1251182e50f20dca1664480fa12c3efec8d4fb166  0274-linuxefi-Invalidate-i-cache-before-starting-the-kern.patch
be6ba7b8fdf9a5284beaad24dfcc630250e5091813db9988c625d1b93e41884fb9a05adc423718274ceba80171246785698ac0173a8760c24045bed6a0678f02  0275-x86-efi-Fix-an-incorrect-array-size-in-kernel-alloca.patch
b15038fa70b83c28f4cd8b6f8e2d5e0240c53853ba5ab72c537e9e8980b5ac8fa6982699b674176ed707d9bc6d57864080ce582802d7cade84006d6801731d7d  0279-font-Reject-glyphs-exceeds-font-max_glyph_width-or-f.patch
7b299876938c4f7da7e3cb54195ca4e7515421c1434eb48e743787aa9e36b9bf64f76797abc2a65a6bc9fc124df5d7114ac88e8ea1aa385b69b6ef9ae70ea868  0280-font-Fix-size-overflow-in-grub_font_get_glyph_intern.patch
ef73c7b43680d2f6ed8fc3adba0bcd030c2f6eaef84ab03e2a3a3325b930e371a3b6d531395b716f257a1eb19c68671923da902d20995b38493de59cc08e44dd  0281-font-Fix-several-integer-overflows-in-grub_font_cons.patch
0c651b3e792d36c46f3fc4df5d709b37cfd251aa9d8e896873d5ecf5a49b42acd75065b0e82db1b39ce707cfa6fd22f995eb299859c35094f522d78d2ad204b3  0282-font-Remove-grub_font_dup_glyph.patch
223cfd5c8a24ec7c1284e6173af59abcb9b6d73c335002a99763db986444795418f0d90774fc3ec3c53039c9617dc3f102acb8f68a39c2b3f5670fd3b00751c3  0283-font-Fix-integer-overflow-in-ensure_comb_space.patch
83025ed7c2c4ce0b69fe3343b1ca944415ab466c95c01bf15c0404cc985308531095b747a3bcefd2b9a504ea48d3a778e68637e019596e0bf11205034a27c118  0284-font-Fix-integer-overflow-in-BMP-index.patch
6a4716282eb5fcc2421b1d62fd4b8926d8bc127cabbc7c123710d0ee33f045b5aa377e3d5968f209053f7fc7da3b7f1b58dc58cd433b70b55f7a64e1e0ac441b  0285-font-Fix-integer-underflow-in-binary-search-of-char-.patch
f8c764e789e3b0031543d84186825dcbe94f60c6588674994ef021d97a7f0cc840a32340387ef5e93f901f152b0d488ff681fe594fc37194acbb189239522044  0286-kern-efi-sb-Enforce-verification-of-font-files.patch
fc89a4d699310635f293a997597525251c077e19b0cf4a35e81e4637c9129fe1f5921c59e74030247fa220b812f3b8ae122400bc7de3ab15ef7885841dbacc14  0287-fbutil-Fix-integer-overflow.patch
d2ce3a4d172e4993b2420fc872ea3b0a066afd4c8ce902ced6d6a888c2ad89b0063ed23256778c09ff407eb441f669c0426218bbef851d4a9ea8603beb7dc39b  0288-font-Fix-an-integer-underflow-in-blit_comb.patch
7c3b1dee5bcab8aac352713810efa73c3373bda1b529dbfb28a394c921dff4c06b69c21a1e28f50baac075b08ef8110782ebe517708aa4d579f3fe55019cdf23  0289-font-Harden-grub_font_blit_glyph-and-grub_font_blit_.patch
aeddbfbfa1cab27c8a845087054db49f1d3a4afe386df3d66a2203a6f6d85636fc98d880a6e44445a6ea8ac22ecb0207b1db82a4b305051ffb68d8a557791dce  0290-font-Assign-null_font-to-glyphs-in-ascii_font_glyph.patch
b01c9776407091e2e553677dae868266e4e6fceb21cd413e19e9544a62a75e7ecf9da803b2f9976639b43ebe4f443653b6f02ceb97a359cbc6af09653fce94f9  0291-normal-charset-Fix-an-integer-overflow-in-grub_unico.patch
736cc978c1c453e7df6f6a3e3085be0aafaf78a06ec0e7204ebd031879c0954e7de0cf82a4ab9dd74daaa10674aacd7bf3792c2bf2343006d919d87750a216f0  0292-font-Try-opening-fonts-from-the-bundled-memdisk.patch
7e55c9a51e6f9a9e332e4dad5f37de248e6854a39937eb90abf4fc044ed249cc9f3ad3af2028d80782a4ec22fd5c4ab5dc162027481096bb4898de769498bc4c  1001-osdep-Introduce-include-grub-osdep-major.h-and-use-i.patch
a93e217f0a08a4ef52dd86cabd19bd33a576940b2792d016b004691c28916e82f66fe3af7e9195d76f464d84210fe249b49a7b6c5f669baacbf4d346d666a891  1002-osdep-linux-hostdisk-Use-stat-instead-of-udevadm-for.patch
933c54a03379277a5c978f9914cc00fbb11194d6335cc984ca6dae1658460b852b73d94d5d10d050ad4c931176da261576b6d7739a150e1562688f4ceb76cf6f  1003-build-Fix-build-error-with-binutils-2.36.patch
e651a1fb82798c256b79ed31060775329b92b76fa6a46b10161ade38371f9e69156efab47bb2c2ee1a9265512133d9c1ef445b0e4f1bb7318c52f5eec79e4ab9  1004-templates-Improve-initramfs-detection.patch
77fcacf98c55be164dfe65c5daabb8dbd172b09e202793c7e492c2c11da235ff6c4868725eed786f7e73e0f17384fdab2441c9cf9e522b2c1a3ae8c154dc0e1d  1005-configure-Fix-misspelled-variable-BUILD_LDFAGS-BUILD.patch
9a486f6cc31c0cbab5069a3877cd4862daef9d0c033eeaf6f0ca0c78edd0d42341ba81abd2ab5d9df65228c277791ab07239b6d1c52acc84687e3d0f5476b497  1006-loader-Drop-argv-argument-in-grub_initrd_load.patch
c2a88636006258b29c20c633f6cca056f4043268bef2f6d034b2602f73371acf011e4027f7e3f8b3ee349407cd4341dd9a185b79cc7a97111443edee012506c1  1007-efi-Move-MS-DOS-stub-out-of-generic-PE-header-defini.patch
c2c81fa4f11e1259ce342834b31e647874ff5a09bb0dd0557b985e2390a5ff476abc78673abc62d0ca47e3122751a8de877f7932f3a8ad0c0feae128485d77fc  1009-loader-arm64-linux-Account-for-COFF-headers-appearin.patch
d9d8e9f8a266d9e9edbc18e9ed7dd11a3fa5fe330218bc0cf4ab4d321abac1029f31e334c395292a928c5a8c5a69b4b937642ab5b88e381a52b1bf0da3a7b2ca  1010-arm64-efi-linux-Implement-LoadFile2-initrd-loading-p.patch
2e9979544bcd1a35ac3320b75224d9415278bcdd82ce1a1846a2e19b9bbf9b3c88c6a8508ab1f1a83a86d4a776847f732e33c0c6ba08791a622dfb561a26f3cc  1011-arm64-efi-linux-Ignore-FDT-unless-we-need-to-modify-.patch
4475251e8754b8e715c69689048f587040774e80e662e0d4c4e1575e424ee8b02192a2dbd7b95dfc09d4af56158b561d6a5daa300e4bb61586ba7456abd36e4a  1012-templates-Filter-out-POSIX-locale-for-translation.patch
f7670f4ade09358b3449423fb22e10e6acdbe4033c63de8fe10ca3211dc13e67089d5b1012e39a6c46481013c540d14ae7fe6142e03aefdcd18e89b2d1939abd  1013-templates-Filter-C.UTF-8-locale-for-translation.patch
465cdfc0254b91fec6ac33fd09553a9a94b738d6364e72e60cc699440ca81d9101a8627949f12ff8bdb384f6ea54bf8c34ad4f6f050352aa980f061b6b284dc7  1014-fs-ext2-Ignore-checksum-seed-incompat-feature.patch
929d3e88ee3a9e936d22624978d1fdd2d000225f33ca747f03c65b5f9623b1a30e09f691e130e48f94d34f64818b422a0ac7a04918b84a4c762f5e58517d0506  1015-fs-ext2-Ignore-the-large_dir-incompat-feature.patch
0492a49e744395af172c8e0f72d14e2808c3ab805bac81041d8d9721d398b79ed64b6d088059124cc31c15d381e7b6d4b9197ce8d4577c4dbe74c2122991f4a7  1016-video-readers-Add-artificial-limit-to-image-dimensio.patch
6a631ba877542f2ba0837cc3f9bfcc8192dc735ec1c4185fd6c0e2a0246c08a3355665851335619b5ed136ac4c81f018635e833bbfe6c6f7e5a0f39940dc67c5  1017-Fix-grub-mkconfig-detection-of-linux-edge-virt.patch
97719bfd538b8b328a1b2a975bea4c836cea2b2c391d24f4ec66a4626c6ae2aecd4d5a343061d08174299db8556f07d6d0353485f7c2205f8d960ea2ea50e90e  1018-ensure-grub-mkconfig-ignores-.apk-new-files.patch
334e4559eb63ba3861b35d9502524dc6e6faa6af56c54554960854c293f9c524cddbb778f9bd7d0bd4f4e4ce8bfa5b9b0087445c2174b733c95640e44df38e6c  1019-prevent-harmless-LVM-warnings-from-grub-probe.patch
333231df2394a9257352b51712f9dd386193d6e52d591ad8456e54b4fb585e425ceb62843928d4e5e82dc17debe31eb7dc0ccca0cec7352303c718f58987e1ec  1020-Handle-encrypted-zfs-root-partition.patch
438d8baf52b9b69dcaaf064a3e8d770991f50ab9262a32ac5cbd9059a2aff8426ebe3c4b8e70a27884fc3fbd1fc3b4e1701cad8c0378902ba29b738e3cb4a90c  1101-fixes-for-menu.patch
"
