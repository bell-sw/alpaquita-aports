Patch-Source: https://gitlab.gnome.org/GNOME/gtk/-/commit/66a94161bd35f1e008abe05cfe1e42ea119394a3
https://gitlab.gnome.org/GNOME/gtk/-/merge_requests/5754
--
From 60d197fca8f59a78e7d8cffc505af34680bcf697 Mon Sep 17 00:00:00 2001
From: Phil Stopford <philstopford@gmail.com>
Date: Thu, 30 Mar 2023 22:34:55 +0000
Subject: [PATCH] Address issue 5711 by checking that the context is not NULL.

---
 gdk/gdkgl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/gdk/gdkgl.c b/gdk/gdkgl.c
index 61cf16417b4..666b5e81335 100644
--- a/gdk/gdkgl.c
+++ b/gdk/gdkgl.c
@@ -367,7 +367,7 @@ gdk_cairo_draw_from_gl (cairo_t              *cr,
 
   clip_region = gdk_cairo_region_from_clip (cr);
 
-  if (gdk_gl_context_get_current () != paint_context)
+  if ((gdk_gl_context_get_current () != NULL) && (gdk_gl_context_get_current () != paint_context))
     sync = glFenceSync (GL_SYNC_GPU_COMMANDS_COMPLETE, 0);
 
   gdk_gl_context_make_current (paint_context);
-- 
GitLab

