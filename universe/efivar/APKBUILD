pkgname=efivar
pkgver=38
pkgrel=4
pkgdesc="Tools and library to manipulate EFI variables"
url="https://github.com/rhboot/efivar"
arch="x86_64"
license="LGPL-2.1-only"
makedepends="popt-dev linux-headers bsd-compat-headers mandoc"
subpackages="$pkgname-dev $pkgname-doc $pkgname-libs"
source="https://github.com/rhboot/efivar/releases/download/$pkgver/efivar-$pkgver.tar.bz2
	lfs64.patch
	0001-efisecdb-replace-on_exit-with-portable-atexit.patch
	"

build() {
	libdir="/usr/lib" make
}

package() {
	libdir="/usr/lib" make DESTDIR="$pkgdir" install
}

check() {
	LD_LIBRARY_PATH="$builddir"/src \
		"$builddir"/src/efivar --help > /dev/null
}

sha512sums="
c2f17297c863ece134a9dd758d237fd2df8c8d072f87af1d0bf2bcf9acfc7a53c25597f03fd4fb8cc664b205743d4ffa0ef1b068d0f73c58fa573d40993f3155  efivar-38.tar.bz2
b267ed990e1d89209dc9d1b875d186def8ba58c404e22bee6fdc91fd469c4673fda8605b52af1cdadf361b530c1e81c3f8d5f1374ad6f647dfee1bb0a9e0a4ba  lfs64.patch
7ec5513d4243bd092f37ec589ed0919894a1e8f7567103cb47113deccc7b707c7d6c38d9d0cdeca711fc0b5d51e964ba7e9ce7f027a37fb25e4a493857ff6ab5  0001-efisecdb-replace-on_exit-with-portable-atexit.patch
"
